@model Fuddo.Models.Order
@{
    ViewData["Title"] = "Chi tiết đơn hàng #" + Model.Id;
}
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
<div class="container mt-4">
    <h2 class="mb-4">Chi tiết đơn hàng #@Model.Id</h2>

    <div class="row">
        <div class="col-md-6">
            <h5>Thông tin người nhận</h5>
            <p><strong>Họ tên:</strong> @Model.User.FullName</p>
            <p><strong>Số điện thoại:</strong> @Model.Phone</p>
            <p><strong>Địa chỉ:</strong> @Model.Address</p>
            @if (!string.IsNullOrEmpty(Model.Note))
            {
                <p><strong>Ghi chú:</strong> @Model.Note</p>
            }
        </div>

        <div class="col-md-6">
            <h5>Thông tin đơn hàng</h5>
            <p><strong>Ngày đặt:</strong> @Model.OrderDate.ToString("dd/MM/yyyy HH:mm")</p>
            <p><strong>Tình trạng:</strong> @Model.Status</p>
            <p><strong>Tổng tiền:</strong> <span class="text-danger fw-bold">@Model.TotalAmount.ToString("N0") ₫</span></p>

            @if (Model.Status == Fuddo.Models.OrderStatus.Pending || Model.Status == Fuddo.Models.OrderStatus.Processing)
            {
                <form asp-action="Cancel" asp-controller="Order" method="post" class="mt-2">
                    <input type="hidden" name="id" value="@Model.Id" />
                    <button type="submit" class="btn btn-danger"
                            onclick="return confirm('Bạn có chắc chắn muốn hủy đơn hàng này không?');">
                        <i class="bi bi-x-circle"></i> Hủy đơn hàng
                    </button>
                </form>
            }
        </div>

    </div>

    <hr />

    <h5>Danh sách sản phẩm</h5>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Sản phẩm</th>
                <th>Đơn giá</th>
                <th>Số lượng</th>
                <th>Thành tiền</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.OrderDetails)
            {
                <tr>
                    <td>@item.Product?.Name</td>
                    <td>@item.UnitPrice.ToString("N0") ₫</td>
                    <td>@item.Quantity</td>
                    <td>@((item.UnitPrice* item.Quantity).ToString("N0")) ₫</td>
                </tr>
            }
        </tbody>
    </table>

    <a href="/Order/My" class="btn btn-secondary mt-3">Quay lại danh sách đơn hàng</a>
</div>
